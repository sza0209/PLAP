# Data Visualization 1 Assignment

# Name: Sinka Khadijah Abubakar

### Question 1 (5 pts.)

Using ggplot, create a boxplot of DON by Treatment so that the plot looks like the image below.
a. Jitter points over the boxplot and fill the points and boxplots Cultivar with two colors from the cbbPallete introduced last week.
b. Change the transparency of the jittered points to 0.6.
c. The y-axis should be labeled "DON (ppm)", and the x-axis should be left blank.
d. The plot should use a classic theme
e. The plot should also be faceted by Cultivar

```{r}
# Loading ggplot2 and ggpubR library
library(ggplot2)
library(ggpubr)

# Loading and checking mycotoxin data
mycotoxin <- read.csv("MycotoxinData.csv", na.strings = "na")
str(mycotoxin)
```


```{r}
# Defining cbbPalette
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")

# creating a boxplot of DON by Treatment
plotA = ggplot(mycotoxin, aes(x = Treatment, y = DON, fill = Cultivar)) +
  geom_boxplot(position = position_dodge()) +
  geom_point(aes(fill = Cultivar), shape = 21, position = position_jitterdodge(dodge.width = 0.9), alpha = 0.6, color = "black") +     # Jittering points, changing transparency of points to 0.6
  scale_fill_manual(values = c(cbbPalette[[3]], cbbPalette[[4]])) +
  facet_wrap(~Cultivar) +    # faceting cultivar
  xlab("") +
  ylab("DON (ppm)") +    # labeling y-axis
  theme_classic()       # adding theme classic
plotA
```


### Question 2 (4 pts.)

Change the factor order level so that the treatment “NTC” is first, followed by “Fg”, “Fg + 37”, “Fg + 40”, and “Fg + 70. 

```{r}
# Changing the factor order level for treatment
mycotoxin$Treatment <- factor(mycotoxin$Treatment,
                              levels = c("NTC", "Fg", "Fg + 37", "Fg + 40", "Fg + 70"))
```



### Question 3 (5 pts.)

Change the y-variable to plot X15ADON and MassperSeed_mg. The y-axis label should now be “15ADON” and “Seed Mass (mg)”. Save plots made in questions 1 and 3 into three separate R objects.

```{r}
# creating a boxplot of X15ADON by Treatment
plotB = ggplot(mycotoxin, aes(x = Treatment, y = X15ADON, fill = Cultivar)) +
  geom_boxplot(position = position_dodge()) +
  geom_point(aes(fill = Cultivar), shape = 21, position = position_jitterdodge(dodge.width = 0.9), alpha = 0.6, color = "black") +     # Jittering points, changing transparency of points to 0.6
  scale_fill_manual(values = c(cbbPalette[[3]], cbbPalette[[4]]), labels = c("NTC", "Fg", "Fg + 37", "Fg + 40", "Fg + 70")) +
  facet_wrap(~Cultivar) +    # faceting cultivar
  xlab("") +
  ylab("15ADON") +    # labeling y-axis
  theme_classic()
plotB
```


```{r}
# creating a boxplot of MassperSeed_mg by Treatment
plotC = ggplot(mycotoxin, aes(x = Treatment, y = MassperSeed_mg, fill = Cultivar)) +
  geom_boxplot(position = position_dodge()) +
  geom_point(aes(fill = Cultivar), shape = 21, position = position_jitterdodge(dodge.width = 0.9), alpha = 0.6, color = "black") +     # Jittering points, changing transparency of points to 0.6
  scale_fill_manual(values = c(cbbPalette[[3]], cbbPalette[[4]]), labels = c("NTC", "Fg", "Fg + 37", "Fg + 40", "Fg + 70")) +
  facet_wrap(~Cultivar) +    # faceting cultivar
  xlab("") +
  ylab("Seed Mass (mg)") +    # labeling y-axis
  theme_classic()
plotC
```


### Question 4 (5 pts.)

Use ggarrange function to combine all three figures into one with three columns and one row. Set the labels for the subplots as A, B and C. Set the option common.legend = T within ggarage function. What did the common.legend option do?
a.	HINT: I didn’t specifically cover this in the tutorial, but you can go to the help page for the ggarange function to figure out what the common.legend option does and how to control it. 

```{r}
# Using ggarrange function to combine all three figures into one with three columns and one row.
figure <- ggarrange(
  plotA,  # First plot (DON by Treatment)
  plotB,  # Second plot (X15ADON by Treatment)
  plotC,  # Third plot (MassperSeed_mg by Treatment)
  labels = c("A", "B", "C"),  # label the plots (A, B, C)
  nrow = 1,  # Arrange the plots in 3 rows
  ncol = 3,  # Arrange the plots in 1 column
  common.legend = TRUE  # Including a legend in the combined figure
)
figure
```
The common.legend option combines the legends from all plots into one shared legend instead of repeating the same legend for each subplot.


### Question 5 (5 pts.)

Use geom_pwc() to add t.test pairwise comparisons to the three plots made above. Save each plot as a new R object, and combine them again with ggarange as you did in question 4. Your final plot should look something like this. 

```{r}
# adding t.test pairwise comparisons to all the plots above
plotD <- plotA +
  geom_pwc(aes(group = Treatment), method = "t_test", label = "{p.adj.format}{p.adj.signif}")

plotE <- plotB +
  geom_pwc(aes(group = Treatment), method = "t_test", label = "{p.adj.format}{p.adj.signif}")

plotF <- plotC +
  geom_pwc(aes(group = Treatment), method = "t_test", label = "{p.adj.format}{p.adj.signif}")
```


```{r}
# Using ggarrange function to combine all three figures into one with three columns and one row.
figure2 <- ggarrange(
  plotD,  # First plot (pwc_DON by Treatment)
  plotE,  # Second plot (pwc_X15ADON by Treatment)
  plotF,  # Third plot (pwc_MassperSeed_mg by Treatment)
  labels = c("A", "B", "C"),  # label the plots (A, B, C)
  nrow = 1,  # Arrange the plots in 3 rows
  ncol = 3,  # Arrange the plots in 1 column
  common.legend = TRUE  # Including a legend in the combined figure
)
figure2
```

